const redis = require("redis");
const redisclient = redis.createClient(
	{
		socket: {
            port: 6379,
            // //`host: "127.0.0.1",
	    	host: 'superone-game-royale-0001-001.jlnwgb.0001.euw2.cache.amazonaws.com'
        }
	}
);

// const redisclient = redis.createClient(6379,'127.0.0.1');


console.time("t1");

(async () => {
	await redisclient.connect();
})();

console.log("Connecting to the Redis");

redisclient.on("ready", () => {
	console.log("Connected!");
});

redisclient.on("error", (err) => {
	console.log("Error in the Connection");
});


let game_tag_questions_Array = ["game_tag_questions_67_2","game_tag_questions_1158_1", "game_tag_questions_139_3", "game_tag_questions_84_1", "game_tag_questions_65_1", "game_tag_questions_106_2", "game_tag_questions_98_3", "game_tag_questions_84_2", "game_tag_questions_1288_2", "game_tag_questions_2_3", "game_tag_questions_1340_3", "game_tag_questions_80_1", "game_tag_questions_139_1", "game_tag_questions_1952_3", "game_tag_questions_78_2", "game_tag_questions_125_1", "game_tag_questions_39_2", "game_tag_questions_87_2", "game_tag_questions_109_3", "game_tag_questions_1112_1", "game_tag_questions_1230_1", "game_tag_questions_89_1", "game_tag_questions_69_2", "game_tag_questions_1068_2", "game_tag_questions_1259_2", "game_tag_questions_62_3", "game_tag_questions_77_1", "game_tag_questions_78_3", "game_tag_questions_78_1", "game_tag_questions_77_2", "game_tag_questions_1176_2", "game_tag_questions_1365_1", "game_tag_questions_108_1", "game_tag_questions_1078_1", "game_tag_questions_85_1", "game_tag_questions_93_2", "game_tag_questions_105_2", "game_tag_questions_97_3", "game_tag_questions_126_3", "game_tag_questions_82_3", "game_tag_questions_1743_2", "game_tag_questions_1306_1", "game_tag_questions_132_1", "game_tag_questions_1278_1", "game_tag_questions_82_2", "game_tag_questions_65_2", "game_tag_questions_86_1", "game_tag_questions_132_3", "game_tag_questions_1420_1", "game_tag_questions_95_3", "game_tag_questions_81_1", "game_tag_questions_64_2", "game_tag_questions_1112_3", "game_tag_questions_123_1", "game_tag_questions_103_2", "game_tag_questions_60_1", "game_tag_questions_112_3", "game_tag_questions_119_3", "game_tag_questions_1168_3", "game_tag_questions_58_2", "game_tag_questions_110_3", "game_tag_questions_1114_2", "game_tag_questions_137_1", "game_tag_questions_84_3", "game_tag_questions_2_2", "game_tag_questions_121_3", "game_tag_questions_1258_1", "game_tag_questions_136_2", "game_tag_questions_1572_1", "game_tag_questions_87_3", "game_tag_questions_1743_3", "game_tag_questions_105_1", "game_tag_questions_114_1", "game_tag_questions_1087_3", "game_tag_questions_122_2", "game_tag_questions_125_2", "game_tag_questions_1324_2", "game_tag_questions_83_3", "game_tag_questions_108_2", "game_tag_questions_126_1", "game_tag_questions_60_3", "game_tag_questions_1263_2", "game_tag_questions_117_2", "game_tag_questions_1877_1", "game_tag_questions_386_2", "game_tag_questions_90_2", "game_tag_questions_39_1", "game_tag_questions_1078_2", "game_tag_questions_65_3", "game_tag_questions_74_1", "game_tag_questions_58_3", "game_tag_questions_1789_3", "game_tag_questions_116_1", "game_tag_questions_86_3", "game_tag_questions_962_3", "game_tag_questions_1486_2", "game_tag_questions_66_3", "game_tag_questions_1989_3", "game_tag_questions_1743_1", "game_tag_questions_60_2", "game_tag_questions_1809_2", "game_tag_questions_1344_3", "game_tag_questions_81_3", "game_tag_questions_104_1", "game_tag_questions_130_2", "game_tag_questions_1087_1", "game_tag_questions_72_3", "game_tag_questions_118_3", "game_tag_questions_47_3", "game_tag_questions_1087_2", "game_tag_questions_70_1", "game_tag_questions_93_3", "game_tag_questions_86_2", "game_tag_questions_1238_3", "game_tag_questions_103_1", "game_tag_questions_1809_3", "game_tag_questions_88_3", "game_tag_questions_75_3", "game_tag_questions_1117_1", "game_tag_questions_2205_3", "game_tag_questions_129_1", "game_tag_questions_64_1", "game_tag_questions_1230_2", "game_tag_questions_109_2", "game_tag_questions_1330_2", "game_tag_questions_59_2", "game_tag_questions_69_1", "game_tag_questions_1184_2", "game_tag_questions_67_1", "game_tag_questions_120_1", "game_tag_questions_1078_3", "game_tag_questions_1522_1", "game_tag_questions_70_2", "game_tag_questions_85_3", "game_tag_questions_71_2", "game_tag_questions_70_3", "game_tag_questions_114_2", "game_tag_questions_61_1", "game_tag_questions_962_2", "game_tag_questions_110_2", "game_tag_questions_2318_2", "game_tag_questions_82_1", "game_tag_questions_1486_3", "game_tag_questions_71_3", "game_tag_questions_1117_2", "game_tag_questions_386_1", "game_tag_questions_1841_2", "game_tag_questions_1278_3", "game_tag_questions_102_1", "game_tag_questions_1340_2", "game_tag_questions_72_2", "game_tag_questions_1869_3", "game_tag_questions_1045_1", "game_tag_questions_72_1", "game_tag_questions_1288_1", "game_tag_questions_80_3", "game_tag_questions_75_2", "game_tag_questions_2_1", "game_tag_questions_1068_3", "game_tag_questions_1176_1", "game_tag_questions_127_2", "game_tag_questions_1262_1", "game_tag_questions_69_3", "game_tag_questions_85_2", "game_tag_questions_80_2", "game_tag_questions_127_1", "game_tag_questions_88_2", "game_tag_questions_112_1", "game_tag_questions_130_3", "game_tag_questions_1068_1", "game_tag_questions_1329_2", "game_tag_questions_93_1", "game_tag_questions_2200_1", "game_tag_questions_79_3", "game_tag_questions_386_3", "game_tag_questions_109_1", "game_tag_questions_66_2", "game_tag_questions_118_1", "game_tag_questions_138_1", "game_tag_questions_76_2", "game_tag_questions_71_1", "game_tag_questions_67_3", "game_tag_questions_1045_3", "game_tag_questions_62_1", "game_tag_questions_105_3", "game_tag_questions_1522_3", "game_tag_questions_139_2", "game_tag_questions_1176_3", "game_tag_questions_1327_1", "game_tag_questions_1112_2", "game_tag_questions_87_1", "game_tag_questions_68_2", "game_tag_questions_74_3", "game_tag_questions_113_2", "game_tag_questions_1168_2", "game_tag_questions_88_1", "game_tag_questions_83_1", "game_tag_questions_59_1", "game_tag_questions_1288_3", "game_tag_questions_115_2", "game_tag_questions_68_1", "game_tag_questions_1862_2", "game_tag_questions_89_3", "game_tag_questions_114_3", "game_tag_questions_96_1", "game_tag_questions_1045_2", "game_tag_questions_117_1", "game_tag_questions_101_2", "game_tag_questions_123_2", "game_tag_questions_100_1", "game_tag_questions_2204_2", "game_tag_questions_61_3", "game_tag_questions_62_2", "game_tag_questions_98_2", "game_tag_questions_131_2", "game_tag_questions_1340_1", "game_tag_questions_64_3", "game_tag_questions_1324_1", "game_tag_questions_96_3", "game_tag_questions_103_3", "game_tag_questions_113_1", "game_tag_questions_1158_3", "game_tag_questions_1066_3", "game_tag_questions_81_2", "game_tag_questions_63_2", "game_tag_questions_77_3", "game_tag_questions_89_2", "game_tag_questions_122_3", "game_tag_questions_1259_1", "game_tag_questions_1838_2", "game_tag_questions_113_3", "game_tag_questions_1092_2", "game_tag_questions_79_1", "game_tag_questions_1324_3", "game_tag_questions_1230_3", "game_tag_questions_63_1", "game_tag_questions_1278_2", "game_tag_questions_61_2", "game_tag_questions_1158_2", "game_tag_questions_94_3", "game_tag_questions_1877_2", "game_tag_questions_121_2", "game_tag_questions_68_3", "game_tag_questions_131_1", "game_tag_questions_104_3", "game_tag_questions_107_3", "game_tag_questions_1114_1", "game_tag_questions_76_1", "game_tag_questions_1066_2", "game_tag_questions_107_2", "game_tag_questions_95_2", "game_tag_questions_79_2", "game_tag_questions_124_1", "game_tag_questions_128_1", "game_tag_questions_2179_3", "game_tag_questions_111_2", "game_tag_questions_98_1", "game_tag_questions_117_3", "game_tag_questions_92_2", "game_tag_questions_97_2", "game_tag_questions_1261_2", "game_tag_questions_92_1", "game_tag_questions_129_2", "game_tag_questions_1838_3", "game_tag_questions_47_2", "game_tag_questions_1076_1", "game_tag_questions_1066_1", "game_tag_questions_76_3", "game_tag_questions_1562_1", "game_tag_questions_110_1", "game_tag_questions_126_2", "game_tag_questions_2338_3", "game_tag_questions_1261_1", "game_tag_questions_96_2", "game_tag_questions_121_1", "game_tag_questions_73_2", "game_tag_questions_130_1", "game_tag_questions_91_2", "game_tag_questions_47_1", "game_tag_questions_74_2", "game_tag_questions_127_3", "game_tag_questions_95_1", "game_tag_questions_39_3", "game_tag_questions_120_3", "game_tag_questions_101_1", "game_tag_questions_962_1", "game_tag_questions_107_1", "game_tag_questions_1114_3", "game_tag_questions_112_2", "game_tag_questions_1306_2", "game_tag_questions_66_1", "game_tag_questions_63_3", "game_tag_questions_102_3", "game_tag_questions_73_3", "game_tag_questions_132_2", "game_tag_questions_1306_3", "game_tag_questions_75_1", "game_tag_questions_83_2", "game_tag_questions_1759_2", "game_tag_questions_116_3", "game_tag_questions_116_2", "game_tag_questions_1076_2", "game_tag_questions_120_2", "game_tag_questions_122_1", "game_tag_questions_1365_2", "game_tag_questions_91_3", "game_tag_questions_1261_3", "game_tag_questions_1330_1", "game_tag_questions_131_3", "game_tag_questions_59_3", "game_tag_questions_58_1", "game_tag_questions_90_1", "game_tag_questions_73_1"];


 let questionIdsArray = [8354, 8355, 8356, 8357, 8358, 8359, 8360, 8361, 8362, 8363, 8364, 8365, 8366, 8367, 8368, 8369, 8370, 8371, 8372, 8373, 8374, 8375, 8376, 8377, 8378, 8379, 8380, 8381, 8382, 8383, 8384, 8385, 8386, 8387, 8388, 8389, 8390, 8391, 8392, 8393, 8394, 8395, 8396, 8397, 8398, 8399, 8400, 8401, 8402, 8403, 8404, 8405, 8406, 8407, 8408, 8409, 8410, 8411, 8412, 8413, 8414, 8415, 8416, 8417, 8418, 8419, 8420, 8421, 8422, 8423, 8424, 8425, 8426, 8427, 8428, 8429, 8430, 8431, 8432, 8433, 8434, 8435, 8436, 8437, 8438, 8439, 8440, 8441, 8442, 8443, 8444, 8445, 8446, 8447, 8448, 8449, 8450, 8451, 8452, 8453, 8454, 8455, 8456, 8457, 8458, 8459, 8460, 8461, 8462, 8463, 8464, 8465, 8466, 8467, 8468, 8469, 8470, 8471, 8472, 8473, 8474, 8475, 8476, 8477, 8478, 8479, 8480, 8481, 8482, 8483, 8484, 8485, 8486, 8487, 8488, 8489, 8490, 8491, 8492, 8493, 8494, 8495, 8496, 8497, 8498, 8499, 8500, 8501, 8502, 8503, 8504, 8505, 8506, 8507, 8508, 8509, 8510, 8511, 8512, 8513, 8514, 8515, 8516, 8517, 8518, 8519, 8520, 8521, 8522, 8523, 8524, 8525, 8526, 8527, 8528, 8529, 8530, 8531, 8532, 8533, 8534, 8535, 8536, 8537, 8538, 8539, 8540, 8541, 8542, 8543, 8544, 8545, 8546, 8547, 8548, 8549, 8550, 8551, 8552, 8553, 8554, 8555, 8556, 8557, 8558, 8559, 8560, 8561, 8562, 8563, 8564, 8565, 8566, 8567, 8568, 8569, 8570, 8571, 8572, 8573, 8574, 8575, 8576, 8577, 8578, 8579, 8580, 8581, 8582, 8583, 8584, 8585, 8586, 8587, 8588, 8589, 8590, 8591, 8592, 8593, 8594, 8595, 8596, 8597, 8598, 8599, 8600, 8601, 8602, 8603, 8604, 8605, 8606, 8607, 8608, 8609, 8610, 8611, 8612, 8613, 8614, 8615, 8616, 8617, 8618, 8619, 8620, 8621, 8622, 8623, 8624, 8625, 8626, 8627, 8628, 8629, 8630, 8631, 8632, 8633, 8634, 8635, 8636, 8637, 8638, 8639, 8640, 8641, 8642, 8643, 8644, 8645, 8646, 8647, 8648, 8649, 8650, 8651, 8652, 8653, 8654, 8655, 8656, 8657, 8658, 8659, 8660, 8661, 8662, 8663, 8664, 8665, 8666, 8667, 8668, 8669, 8670, 8671, 8672, 8673, 8674, 8675, 8676, 8677, 8678, 8679, 8680, 8681, 8682, 8683, 8684, 8685, 8686, 8687, 8688, 8689, 8690, 8691, 8692, 8693, 8694, 8695, 8696, 8697, 8698, 8699, 8700, 8701, 8702, 8703, 8704, 8705, 8706, 8707, 8708, 8709, 8710, 8711, 8712, 8713, 8714, 8715, 8716, 8717, 8718, 8719, 8720, 8721, 8722, 8723, 8724, 8725, 8726, 8727, 8728, 8729, 8730, 8731, 8732, 8733, 8734, 8735, 8736, 8737, 8738, 8739, 8740, 8741, 8742, 8743, 8744, 8745, 8746, 8747, 8748, 8749, 8750, 8751, 8752, 8753, 8754, 8755, 8756, 8757, 8758, 8759, 8760, 8761, 8762, 8763, 8764, 8765, 8766, 8767, 8768, 8769, 8770, 8771, 8772, 8773, 8774, 8775, 8776, 8777, 8778, 8779, 8780, 8781, 8782, 8783, 8784, 8785, 8786, 8787, 8788, 8789, 8790, 8791, 8792, 8793, 8794, 8795, 8796, 8797, 8798, 8799, 8800, 8801, 8802, 8803, 8804, 8805, 8806, 8807, 8808, 8809, 8810, 8811, 8812, 8813, 8814, 8815, 8816, 8817, 8818, 8819, 8820, 8821, 8822, 8823, 8824, 8825, 8826, 8827, 8828, 8829, 8830, 8831, 8832, 8833, 8834, 8835, 8836, 8837, 8838, 8839, 8840, 8841, 8842, 8843, 8844, 8845, 8846, 8847, 8848, 8849, 8850, 8851, 8852, 8853, 8854, 8855, 8856, 8857, 8858, 8860, 8861, 8862, 8863, 8864, 8865, 8866, 8867, 8868, 8869, 8870, 8871, 8872, 8873, 8874, 8875, 8876, 8877, 8878, 8879, 8880, 8881, 8882, 8883, 8884, 8885, 8886, 8888, 8889, 8890, 8891, 8892, 8893, 8894, 8895, 8896, 8897, 8898, 8899, 8900, 8901, 8902, 8903, 8904, 8905, 8906, 8907, 8908, 8909, 8910, 8911, 8912, 8913, 8914, 8915, 8916, 8917, 8918, 8919, 8920, 8921, 8922, 8923, 8924, 8925, 8926, 8927, 8928, 8929, 8930, 8931, 8932, 8933, 8934, 8935, 8936, 8937, 8938, 8939, 8940, 8941, 8942, 8943, 8944, 8945, 8946, 8947, 8948, 8949, 8950, 8951, 8952, 8953, 8954, 8955, 8956, 8957, 8958, 8959, 8960, 8961, 8962, 8963, 8964, 8965, 8966, 8967, 8968, 8969, 8970, 8971, 8972, 8973, 8974, 8975, 8976, 8977, 8978, 8979, 8980, 8981, 8982, 8983, 8984, 8985, 8986, 8987, 8988, 8989, 8990, 8991, 8992, 8993, 8994, 8995, 8996, 8997, 8998, 8999, 9000, 9001, 9002, 9003, 9004, 9005, 9006, 9007, 9008, 9009, 9010, 9011, 9012, 9013, 9014, 9015, 9016, 9017, 9018, 9019, 9020, 9021, 9022, 9023, 9024, 9025, 9026, 9027, 9028, 9029, 9030, 9031, 9032, 9033, 9034, 9035, 9036, 9037, 9038, 9039, 9040, 9041, 9042, 9043, 9044, 9045, 9046, 9047, 9048, 9049, 9050, 9051, 9052, 9053, 9054, 9055, 9056, 9057, 9058, 9059, 9060, 9061, 9062, 9063, 9064, 9065, 9066, 9067, 9068, 9069, 9070, 9071, 9072, 9073, 9074, 9075, 9076, 9077, 9078, 9079, 9080, 9081, 9082, 9083, 9084, 9085, 9086, 9087, 9088, 9089, 9090, 9091, 9092, 9093, 9094, 9095, 9096, 9097, 9098, 9099, 9100, 9101, 9102, 9103, 9104, 9105, 9106, 9107, 9108, 9109, 9110, 9111, 9112, 9113, 9114, 9115, 9116, 9117, 9118, 9119, 9120, 9121, 9122, 9123, 9124, 9125, 9126, 9127, 9128, 9129, 9130, 9131, 9132, 9133, 9134, 9135, 9136, 9137, 9138, 9139, 9140, 9141, 9142, 9143, 9144, 9145, 9146, 9147, 9148, 9149, 9150, 9151, 9152, 9153, 9154, 9155, 9156, 9157, 9158, 9159, 9160, 9161, 9162, 9163, 9164, 9165, 9166, 9167, 9168, 9169, 9170, 9171, 9172, 9173, 9174, 9175, 9176, 9177, 9178, 9179, 9180, 9181, 9182, 9183, 9184, 9185, 9186, 9187, 9188, 9189, 9190, 9191, 9192, 9193, 9194, 9195, 9196, 9197, 9198, 9199, 9200, 9201];


 for(let i=0;i<game_tag_questions_Array.length;i++){
	let questionIdIncluded = false;
	let key = game_tag_questions_Array[i];
	redisclient.get(key).then((res) => {
		let resArray = JSON.parse(res);
		if(resArray != null && resArray.length > 0){
			console.log("got key ====>",key);
			for(let j=0;j<questionIdsArray.length;j++){
					let index = resArray.indexOf(questionIdsArray[j]);
					if (index > -1) {
						resArray.splice(index, 1);
						questionIdIncluded = true;
					}
			}
			if(questionIdIncluded && resArray.length < res.length){
				let setKey = game_tag_questions_Array[i];
				redisclient.set(setKey,JSON.stringify(resArray)).then((res) => {
					console.log("setting key ====>",setKey);
				});
			}
		}
	});
}

console.timeEnd("t1");




